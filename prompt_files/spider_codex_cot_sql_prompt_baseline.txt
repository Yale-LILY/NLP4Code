-- Translate natural language questions into SQL queries.

-- Example:

-- Database game_injury:
--  Table stadium: id, name, Home_Games, Average_Attendance, Total_Attendance, Capacity_Percentage
--  Table game: stadium_id, id, Season, Date, Home_team, Away_team, Score, Competition
--  Table injury_accident: game_id, id, Player, Injury, Number_of_matches, Source
-- Question: How many distinct kinds of injuries happened after season 2010?
-- SQL:
SELECT count(DISTINCT T1.Injury) FROM injury_accident AS T1 JOIN game AS T2 ON T1.game_id  =  T2.id WHERE T2.Season  >  2010

-- Example:

-- Database farm:
--  Table city: City_ID, Official_Name, Status, Area_km_2, Population, Census_Ranking
--  Table farm: Farm_ID, Year, Total_Horses, Working_Horses, Total_Cattle, Oxen, Bulls, Cows, Pigs, Sheep_and_Goats
--  Table farm_competition: Competition_ID, Year, Theme, Host_city_ID, Hosts
--  Table competition_record: Competition_ID, Farm_ID, Rank
-- Question: Return the hosts of competitions for which the theme is not Aliens?
-- SQL:
SELECT Hosts FROM farm_competition WHERE Theme !=  'Aliens'

-- Example:

-- Database school_finance:
--  Table School: School_id, School_name, Location, Mascot, Enrollment, IHSAA_Class, IHSAA_Football_Class, County
--  Table budget: School_id, Year, Budgeted, total_budget_percent_budgeted, Invested, total_budget_percent_invested, Budget_invested_percent
--  Table endowment: endowment_id, School_id, donator_name, amount
-- Question: Show the average, maximum, minimum enrollment of all schools.
-- SQL:
SELECT avg(Enrollment) ,  max(Enrollment) ,  min(Enrollment) FROM School

-- Example:

-- Database cre_Docs_and_Epenses:
--  Table Ref_Document_Types: Document_Type_Code, Document_Type_Name, Document_Type_Description
--  Table Ref_Budget_Codes: Budget_Type_Code, Budget_Type_Description
--  Table Projects: Project_ID, Project_Details
--  Table Documents: Document_ID, Document_Type_Code, Project_ID, Document_Date, Document_Name, Document_Description, Other_Details
--  Table Statements: Statement_ID, Statement_Details
--  Table Documents_with_Expenses: Document_ID, Budget_Type_Code, Document_Details
--  Table Accounts: Account_ID, Statement_ID, Account_Details
-- Question: Return the ids and details corresponding to projects for which there are more than two documents.
-- SQL:
SELECT T1.Project_ID ,  T1.Project_Details FROM Projects AS T1 JOIN Documents AS T2 ON T1.Project_ID  =  T2.Project_ID GROUP BY T1.Project_ID HAVING count(*)  >  2

-- Example:

-- Database local_govt_in_alabama:
--  Table Services: Service_ID, Service_Type_Code
--  Table Participants: Participant_ID, Participant_Type_Code, Participant_Details
--  Table Events: Event_ID, Service_ID, Event_Details
--  Table Participants_in_Events: Event_ID, Participant_ID
-- Question: List the type of the services in alphabetical order.
-- SQL:
SELECT Service_Type_Code FROM Services ORDER BY Service_Type_Code

-- Example:

-- Database cre_Theme_park:
--  Table Ref_Hotel_Star_Ratings: star_rating_code, star_rating_description
--  Table Locations: Location_ID, Location_Name, Address, Other_Details
--  Table Ref_Attraction_Types: Attraction_Type_Code, Attraction_Type_Description
--  Table Visitors: Tourist_ID, Tourist_Details
--  Table Features: Feature_ID, Feature_Details
--  Table Hotels: hotel_id, star_rating_code, pets_allowed_yn, price_range, other_hotel_details
--  Table Tourist_Attractions: Tourist_Attraction_ID, Attraction_Type_Code, Location_ID, How_to_Get_There, Name, Description, Opening_Hours, Other_Details
--  Table Street_Markets: Market_ID, Market_Details
--  Table Shops: Shop_ID, Shop_Details
--  Table Museums: Museum_ID, Museum_Details
--  Table Royal_Family: Royal_Family_ID, Royal_Family_Details
--  Table Theme_Parks: Theme_Park_ID, Theme_Park_Details
--  Table Visits: Visit_ID, Tourist_Attraction_ID, Tourist_ID, Visit_Date, Visit_Details
--  Table Photos: Photo_ID, Tourist_Attraction_ID, Name, Description, Filename, Other_Details
--  Table Staff: Staff_ID, Tourist_Attraction_ID, Name, Other_Details
--  Table Tourist_Attraction_Features: Tourist_Attraction_ID, Feature_ID
-- Question: Show the average price range of hotels that have 5 star ratings and allow pets.
-- SQL:
SELECT avg(price_range) FROM Hotels WHERE star_rating_code  =  "5" AND pets_allowed_yn  =  1

-- Example:

-- Database insurance_fnol:
--  Table Customers: Customer_ID, Customer_name
--  Table Services: Service_ID, Service_name
--  Table Available_Policies: Policy_ID, policy_type_code, Customer_Phone
--  Table Customers_Policies: Customer_ID, Policy_ID, Date_Opened, Date_Closed
--  Table First_Notification_of_Loss: FNOL_ID, Customer_ID, Policy_ID, Service_ID
--  Table Claims: Claim_ID, FNOL_ID, Effective_Date
--  Table Settlements: Settlement_ID, Claim_ID, Effective_Date, Settlement_Amount
-- Question: Find all the phone numbers.
-- SQL:
SELECT Customer_Phone FROM available_policies

-- Example:

-- Database cre_Theme_park:
--  Table Ref_Hotel_Star_Ratings: star_rating_code, star_rating_description
--  Table Locations: Location_ID, Location_Name, Address, Other_Details
--  Table Ref_Attraction_Types: Attraction_Type_Code, Attraction_Type_Description
--  Table Visitors: Tourist_ID, Tourist_Details
--  Table Features: Feature_ID, Feature_Details
--  Table Hotels: hotel_id, star_rating_code, pets_allowed_yn, price_range, other_hotel_details
--  Table Tourist_Attractions: Tourist_Attraction_ID, Attraction_Type_Code, Location_ID, How_to_Get_There, Name, Description, Opening_Hours, Other_Details
--  Table Street_Markets: Market_ID, Market_Details
--  Table Shops: Shop_ID, Shop_Details
--  Table Museums: Museum_ID, Museum_Details
--  Table Royal_Family: Royal_Family_ID, Royal_Family_Details
--  Table Theme_Parks: Theme_Park_ID, Theme_Park_Details
--  Table Visits: Visit_ID, Tourist_Attraction_ID, Tourist_ID, Visit_Date, Visit_Details
--  Table Photos: Photo_ID, Tourist_Attraction_ID, Name, Description, Filename, Other_Details
--  Table Staff: Staff_ID, Tourist_Attraction_ID, Name, Other_Details
--  Table Tourist_Attraction_Features: Tourist_Attraction_ID, Feature_ID
-- Question: Which transportation method is used the most often to get to tourist attractions?
-- SQL:
SELECT How_to_Get_There FROM Tourist_Attractions GROUP BY How_to_Get_There ORDER BY COUNT(*) DESC LIMIT 1